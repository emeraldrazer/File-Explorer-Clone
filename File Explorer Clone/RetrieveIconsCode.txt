// Get Icons
Icon fileIcon = System.Drawing.Icon.ExtractAssociatedIcon(text);
                ImageSource fileImageSource = Imaging.CreateBitmapSourceFromHIcon(
                    fileIcon.Handle,
                    Int32Rect.Empty,
                    BitmapSizeOptions.FromEmptyOptions());

                stackPanel.Children.Add(new System.Windows.Controls.Image() { Source = fileImageSource, Width = 25, Height = 25, Margin = new Thickness(5, 5, 0, 0) });

                fileIcon.Dispose();

//try
            //{
            //    Icon icon = System.Drawing.Icon.ExtractAssociatedIcon(text);

            //    ImageSource imageSource = Imaging.CreateBitmapSourceFromHIcon(
            //                icon.Handle,
            //                Int32Rect.Empty,
            //                BitmapSizeOptions.FromEmptyOptions());

            //    stackPanel.Children.Add(new System.Windows.Controls.Image() { Source = imageSource, Width = 25, Height = 25, Margin = new Thickness(5, 5, 0, 0) });
            //    stackPanel.Children.Add(new TextBlock() { Text = text.Split('\\').Last(), FontSize = 15, Margin = new Thickness(5, 0, 0, 0), VerticalAlignment = VerticalAlignment.Center, HorizontalAlignment = HorizontalAlignment.Center });

            //    AllObjects.Children.Add(stackPanel);

            //    icon.Dispose();
            //}
            //catch 
            //{

            //}